!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.spraypaint={})}(this,function(t){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function c(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function e(t,e,r,i){var n,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;0<=a;a--)(n=t[a])&&(o=(s<3?n(o):3<s?n(e,r,o):n(e,r))||o);return 3<s&&o&&Object.defineProperty(e,r,o),o}function s(t,o,a,c){return new(a=a||Promise)(function(r,e){function i(t){try{s(c.next(t))}catch(t){e(t)}}function n(t){try{s(c.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?r(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,n)}s((c=c.apply(t,o||[])).next())})}function u(r,i){var n,s,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,(e=o?[2&e[0],o.value]:e)[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(r,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var o=(r.apply=function(t,e){new r(t,e).apply()},r.prototype.apply=function(){var i=this,n={};this.payload.errors&&(this.payload.errors.forEach(function(t){var e=t.meta;if(!e)throw new Error("invalid json");var r=e.relationship;r?i._processRelationship(i.model,r,t):i._processResource(n,e,t)}),this.model.errors=n)},r.prototype._processResource=function(t,e,r){var i=this.model.klass.deserializeKey(e.attribute);t[i]={title:r.title,code:r.code,attribute:e.attribute,message:e.message,fullMessage:"base"===i?e.message:r.detail,rawPayload:r}},r.prototype._processRelationship=function(t,e,r){var i,n,s=t[t.klass.deserializeKey(e.name)];Array.isArray(s)&&(s=s.find(function(t){return t.id&&String(t.id)===String(e.id)||t.temp_id&&t.temp_id===e["temp-id"]})),e.relationship?this._processRelationship(s,e.relationship,r):(this._processResource(i={},e,r),n={},Object.keys(s.errors).forEach(function(t){n[t]=s.errors[t]}),Object.keys(i).forEach(function(t){var e=i[t];void 0!==e&&(n[t]=e)}),s.errors=n)},r);function r(t,e){this.model=t,this.payload=e}function a(t,e){(e=e.headers.get("X-JWT"))&&t.setJWT(e)}function l(t,e){if(function(){if(typeof window===undefined)if(/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM))return true;else return false;else return false}()){t=p[t];return"["+t[0]+"m"+e+"["+t[1]+"m"}return e}var p={green:[32,39],cyan:[36,39],magenta:[35,39],bold:[1,22]},h=(f.prototype.get=function(t,e){return e.method="GET",this._fetchWithLogging(t,e)},f.prototype.post=function(t,e,r){return r.method="POST",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},f.prototype.patch=function(t,e,r){return this.config.patchAsPost?(r.method="POST",r.headers||(r.headers={}),r.headers["X-HTTP-Method-Override"]="PATCH"):r.method="PATCH",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},f.prototype.delete=function(t,e){return e.method="DELETE",this._fetchWithLogging(t,e)},f.prototype._logRequest=function(t,e){this.logger.info(l("cyan",t+": ")+l("magenta",e))},f.prototype._logResponse=function(t){this.logger.debug(l("bold",JSON.stringify(t,null,4)))},f.prototype._fetchWithLogging=function(r,i){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return this._logRequest(i.method||"UNDEFINED METHOD",r),[4,this._fetch(r,i)];case 1:return e=t.sent(),this._logResponse(e.jsonPayload),[2,e]}})})},f.prototype._fetch=function(i,n){return s(this,void 0,void 0,function(){var e,r;return u(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.middleware.beforeFetch(i,n)];case 1:return t.sent(),[3,3];case 2:throw r=t.sent(),new y("beforeFetch failed; review middleware.beforeFetch stack",i,n,r);case 3:return t.trys.push([3,5,,6]),[4,fetch(i,n)];case 4:return e=t.sent(),[3,6];case 5:throw(r=t.sent())instanceof Error?new g(null,r.message,r):new g(null,"e was not an instance of Error",r);case 6:return[4,this._handleResponse(e,n)];case 7:return t.sent(),[2,e]}})})},f.prototype._handleResponse=function(i,n){return s(this,void 0,void 0,function(){var e,r;return u(this,function(t){switch(t.label){case 0:if("DELETE"===n.method&&-1<[204,200].indexOf(i.status))return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.clone().json()];case 2:return e=t.sent(),[3,4];case 3:if(r=t.sent(),-1<[202,204].indexOf(i.status))return[2];throw new g(i,"invalid json",r);case 4:return t.trys.push([4,6,,7]),[4,this.middleware.afterFetch(i,e)];case 5:return t.sent(),[3,7];case 6:throw r=t.sent(),new g(i,"afterFetch failed; review middleware.afterFetch stack",r);case 7:if(500<=i.status)throw new g(i,"Server Error");if(422!==i.status&&void 0===e.data)throw 404===i.status?new g(i,"record not found"):new g(i,"invalid json");return i.jsonPayload=e,[2]}})})},f);function f(t,e,r){this.middleware=t,this.logger=e,this.config=Object.assign({patchAsPost:!1},r)}var d,y=(c(b,d=Error),b);function b(t,e,r,i){t=d.call(this,t)||this;return i instanceof Error&&(t.stack=i.stack),t.url=e,t.options=r,t.originalError=i,t}var v,g=(c(_,v=Error),_);function _(t,e,r){e=v.call(this,e||"Invalid Response")||this;return e.response=t,e.originalError=r,e}var m=(j.prototype.toScopeObject=function(){var t,e={};for(t in this.dct)this.dct.hasOwnProperty(t)&&(e[t]=this.dct[t].toScopeObject());return e},j.prototype.toString=function(){var t,r=[],i=this;for(t in this.dct)!function(e){var t;i.dct.hasOwnProperty(e)&&(""===(t=i.dct[e].toString())?r.push(e):(t=(t=t.split(",")).map(function(t){return e+"."+t}),r.push(t.join(","))))}(t);return r.join(",")},j.prototype._parseIncludeArgs=function(t){if(Array.isArray(t))return this._parseArray(t);if("string"!=typeof t)return"object"==typeof t?this._parseObject(t):{};var e={};return e[t]={},e},j.prototype._parseObject=function(t){var e,r={};for(e in t)t.hasOwnProperty(e)&&(r[e]=this._parseIncludeArgs(t[e]));return r},j.prototype._parseArray=function(t){for(var e={},r=0,i=t;r<i.length;r++){var n,s=i[r],o=this._parseIncludeArgs(s);for(n in o)o.hasOwnProperty(n)&&(e[n]=o[n])}return e},j);function j(t){this.dct={};var e,r=this._parseIncludeArgs(t);for(e in r)r.hasOwnProperty(e)&&(this.dct[e]=new j(r[e]))}var w=0,O=function(){return"temp-id-"+ ++w},k=(A.prototype.attributes=function(){var i=this,n={};return this._eachAttribute(function(t,e,r){i.model.isPersisted&&!i.model.changes()[t]||(t=i.model.klass.serializeKey(t),r.type===Number&&""===e?n[t]=null:n[t]=e)}),n},A.prototype.removeDeletions=function(e,s){var o=this;Object.keys(s).forEach(function(r){var i=s[r],n=e,t=n[r];t&&(Array.isArray(t)?t.forEach(function(t,e){t.isMarkedForDestruction||t.isMarkedForDisassociation?n[r].splice(e,1):o.removeDeletions(t,i)}):(t=t).isMarkedForDestruction||t.isMarkedForDisassociation?n[r]=null:o.removeDeletions(t,i))})},A.prototype.postProcess=function(){this.removeDeletions(this.model,this.includeDirective),this.model.resetRelationTracking(this.includeDirective)},A.prototype.relationships=function(){var s=this,o={};return Object.keys(this.includeDirective).forEach(function(e){var r,i=s.includeDirective[e],n=!1;-1<e.indexOf(".")&&(e=e.split(".")[0],n=!0);var t=s.model[e];t&&(Array.isArray(t)?(r=[],t.forEach(function(t){!s._isNewAndMarkedForDestruction(t)&&(n||s.model.hasDirtyRelation(e,t)||t.isDirty(i))&&r.push(s._processRelatedModel(t,i,n))}),0===r.length&&(r=null)):!s._isNewAndMarkedForDestruction(t)&&(n||s.model.hasDirtyRelation(e,t)||t.isDirty(i))&&(r=s._processRelatedModel(t,i,n)),r&&(o[s.model.klass.serializeKey(e)]={data:r}))}),o},A.prototype.asJSON=function(){var t={type:this.jsonapiType};this.model.id&&(t.id=this.model.id),this.model.temp_id&&(t["temp-id"]=this.model.temp_id),this.idOnly||(r=this.attributes(),0<Object.keys(r).length&&(t.attributes=r));var e=this.relationships();0<Object.keys(e).length&&(t.relationships=e);var r={data:t};0<this.included.length&&(r.included=this.included);e=this.model.meta;return this.model.isMetaDirty&&0<Object.keys(e).length&&(t.meta=e),r},A.prototype._isNewAndMarkedForDestruction=function(t){return!t.isPersisted&&t.isMarkedForDestruction},A.prototype._processRelatedModel=function(e,t,r){var i=this;e.clearErrors(),e.isPersisted||(e.temp_id=O());t=new A(e,t,r),r=t.asJSON().data;return this._isNewAndMarkedForDestruction(e)||this._pushInclude(r),t.included.forEach(function(t){i._isNewAndMarkedForDestruction(e)||i._pushInclude(t)}),this._resourceIdentifierFor(e)},A.prototype._resourceIdentifierFor=function(t){if(!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType for model "+t);var e={type:t.klass.jsonapiType};return t.id&&(e.id=t.id),t.temp_id&&(e["temp-id"]=t.temp_id),t=t.isPersisted?t.isMarkedForDestruction?"destroy":t.isMarkedForDisassociation?"disassociate":"update":"create",e.method=t,e},A.prototype._pushInclude=function(t){this._isIncluded(t)||this.included.push(t)},A.prototype._isIncluded=function(e){return this.included.forEach(function(t){if(t.type===e.type&&(t.id===e.id||t["temp-id"]===e["temp-id"]))return!0}),!1},A.prototype._eachAttribute=function(i){var n=this,s=this.model.typedAttributes;Object.keys(s).forEach(function(t){var e,r=n.model.klass.attributeList[t];r.persist&&(e=s[t],i(t,e,r))})},A);function A(t,e,r){void 0===r&&(r=!1),this.included=[],this.idOnly=!1;e=new m(e);if(this.includeDirective=e.toScopeObject(),this.model=t,this.idOnly=r,!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType");this.jsonapiType=t.klass.jsonapiType}var P,C=(S.prototype.getItem=function(t){return this._data[t]||null},S.prototype.setItem=function(t,e){this._data[t]=e},S.prototype.removeItem=function(t){delete this._data[t]},S);function S(){this._data={}}try{P=localStorage}catch(t){P=new C}var R=(Object.defineProperty($.prototype,"backend",{get:function(){return this._backend},enumerable:!1,configurable:!0}),$.prototype.getJWT=function(){return this._backend.getItem(this._jwtKey)||void 0},$.prototype.setJWT=function(t){t?this._backend.setItem(this._jwtKey,t):this._backend.removeItem(this._jwtKey)},$);function $(t,e){void 0===e&&(e=P),this._jwtKey=t,this._backend=e}function E(t,e){return t===e||t!=t&&e!=e}function x(t,e){for(var r=t.length;r--;)if(E(t[r][0],e))return r;return-1}var F=Array.prototype.splice;function T(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}T.prototype.clear=function(){this.__data__=[],this.size=0},T.prototype.delete=function(t){var e=this.__data__;return!((t=x(e,t))<0)&&(t==e.length-1?e.pop():F.call(e,t,1),--this.size,!0)},T.prototype.get=function(t){var e=this.__data__;return(t=x(e,t))<0?void 0:e[t][1]},T.prototype.has=function(t){return-1<x(this.__data__,t)},T.prototype.set=function(t,e){var r=this.__data__,i=x(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this};var D="object"==typeof global&&global&&global.Object===Object&&global,z="object"==typeof self&&self&&self.Object===Object&&self,I=D||z||Function("return this")(),L=I.Symbol,M=Object.prototype,U=M.hasOwnProperty,N=M.toString,B=L?L.toStringTag:void 0;var J=Object.prototype.toString;var K="[object Null]",W="[object Undefined]",H=L?L.toStringTag:void 0;function q(t){return null==t?void 0===t?W:K:H&&H in Object(t)?function(t){var e=U.call(t,B),r=t[B];try{var i=!(t[B]=void 0)}catch(t){}var n=N.call(t);return i&&(e?t[B]=r:delete t[B]),n}(t):J.call(t)}function G(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var Z="[object AsyncFunction]",V="[object Function]",Q="[object GeneratorFunction]",Y="[object Proxy]";function X(t){if(G(t)){t=q(t);return t==V||t==Q||t==Z||t==Y}}var tt=I["__core-js_shared__"],et=(kt=/[^.]+$/.exec(tt&&tt.keys&&tt.keys.IE_PROTO||""))?"Symbol(src)_1."+kt:"";var rt=Function.prototype.toString;function it(t){if(null!=t){try{return rt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var nt=/^\[object .+?Constructor\]$/,st=Function.prototype,z=Object.prototype,M=st.toString,tt=z.hasOwnProperty,ot=RegExp("^"+M.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function at(t){var e;return G(t)&&(e=t,!(et&&et in e))&&(X(t)?ot:nt).test(it(t))}function ct(t,e){e=e,e=null==(t=t)?void 0:t[e];return at(e)?e:void 0}var ut=ct(I,"Map"),lt=ct(Object,"create");var pt=Object.prototype.hasOwnProperty;var ht=Object.prototype.hasOwnProperty;function ft(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function dt(t,e){var r,i=t.__data__;return("string"==(t=typeof(r=e))||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function yt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}ft.prototype.clear=function(){this.__data__=lt?lt(null):{},this.size=0},ft.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},ft.prototype.get=function(t){var e=this.__data__;if(lt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return pt.call(e,t)?e[t]:void 0},ft.prototype.has=function(t){var e=this.__data__;return lt?void 0!==e[t]:ht.call(e,t)},ft.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=lt&&void 0===e?"__lodash_hash_undefined__":e,this},yt.prototype.clear=function(){this.size=0,this.__data__={hash:new ft,map:new(ut||T),string:new ft}},yt.prototype.delete=function(t){return t=dt(this,t).delete(t),this.size-=t?1:0,t},yt.prototype.get=function(t){return dt(this,t).get(t)},yt.prototype.has=function(t){return dt(this,t).has(t)},yt.prototype.set=function(t,e){var r=dt(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this};function bt(t){t=this.__data__=new T(t);this.size=t.size}bt.prototype.clear=function(){this.__data__=new T,this.size=0},bt.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},bt.prototype.get=function(t){return this.__data__.get(t)},bt.prototype.has=function(t){return this.__data__.has(t)},bt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof T){var i=r.__data__;if(!ut||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new yt(i)}return r.set(t,e),this.size=r.size,this};var vt=function(){try{var t=ct(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function gt(t,e,r){"__proto__"==e&&vt?vt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var _t=Object.prototype.hasOwnProperty;function mt(t,e,r){var i=t[e];_t.call(t,e)&&E(i,r)&&(void 0!==r||e in t)||gt(t,e,r)}function jt(t,e,r,i){var n=!r;r=r||{};for(var s=-1,o=e.length;++s<o;){var a=e[s],c=i?i(r[a],t[a],a,r,t):void 0;(n?gt:mt)(r,a,c=void 0===c?t[a]:c)}return r}function wt(t){return null!=t&&"object"==typeof t}function Ot(t){return wt(t)&&"[object Arguments]"==q(t)}var kt=Object.prototype,At=kt.hasOwnProperty,Pt=kt.propertyIsEnumerable,Ct=Ot(function(){return arguments}())?Ot:function(t){return wt(t)&&At.call(t,"callee")&&!Pt.call(t,"callee")},St=Array.isArray;var st="object"==typeof t&&t&&!t.nodeType&&t,z=st&&"object"==typeof module&&module&&!module.nodeType&&module,M=z&&z.exports===st?I.Buffer:void 0,Rt=(M?M.isBuffer:void 0)||function(){return!1},$t=/^(?:0|[1-9]\d*)$/;var Et=9007199254740991;function xt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Et}var Ft={};function Tt(e){return function(t){return e(t)}}Ft["[object Float32Array]"]=Ft["[object Float64Array]"]=Ft["[object Int8Array]"]=Ft["[object Int16Array]"]=Ft["[object Int32Array]"]=Ft["[object Uint8Array]"]=Ft["[object Uint8ClampedArray]"]=Ft["[object Uint16Array]"]=Ft["[object Uint32Array]"]=!0,Ft["[object Arguments]"]=Ft["[object Array]"]=Ft["[object ArrayBuffer]"]=Ft["[object Boolean]"]=Ft["[object DataView]"]=Ft["[object Date]"]=Ft["[object Error]"]=Ft["[object Function]"]=Ft["[object Map]"]=Ft["[object Number]"]=Ft["[object Object]"]=Ft["[object RegExp]"]=Ft["[object Set]"]=Ft["[object String]"]=Ft["[object WeakMap]"]=!1;var tt="object"==typeof t&&t&&!t.nodeType&&t,Dt=tt&&"object"==typeof module&&module&&!module.nodeType&&module,zt=Dt&&Dt.exports===tt&&D.process,kt=function(){try{var t=Dt&&Dt.require&&Dt.require("util").types;return t?t:zt&&zt.binding&&zt.binding("util")}catch(t){}}(),z=kt&&kt.isTypedArray,It=z?Tt(z):function(t){return wt(t)&&xt(t.length)&&!!Ft[q(t)]},Lt=Object.prototype.hasOwnProperty;function Mt(t,e){var r,i,n,s,o=St(t),a=!o&&Ct(t),c=!o&&!a&&Rt(t),u=!o&&!a&&!c&&It(t),l=o||a||c||u,p=l?function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}(t.length,String):[],h=p.length;for(r in t)!e&&!Lt.call(t,r)||l&&("length"==r||c&&("offset"==r||"parent"==r)||u&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||(s=void 0,s=typeof(i=r),(n=null==(n=h)?9007199254740991:n)&&("number"==s||"symbol"!=s&&$t.test(i))&&-1<i&&i%1==0&&i<n))||p.push(r);return p}var Ut=Object.prototype;function Nt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ut)}function Bt(e,r){return function(t){return e(r(t))}}var Jt=Bt(Object.keys,Object),Kt=Object.prototype.hasOwnProperty;function Wt(t){if(!Nt(t))return Jt(t);var e,r=[];for(e in Object(t))Kt.call(t,e)&&"constructor"!=e&&r.push(e);return r}function Ht(t){return null!=t&&xt(t.length)&&!X(t)}function qt(t){return(Ht(t)?Mt:Wt)(t)}var Gt=Object.prototype.hasOwnProperty;function Zt(t){if(!G(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e,r=Nt(t),i=[];for(e in t)("constructor"!=e||!r&&Gt.call(t,e))&&i.push(e);return i}function Vt(t){return Ht(t)?Mt(t,!0):Zt(t)}var st="object"==typeof t&&t&&!t.nodeType&&t,M=st&&"object"==typeof module&&module&&!module.nodeType&&module,tt=M&&M.exports===st?I.Buffer:void 0,Qt=tt?tt.allocUnsafe:void 0;function Yt(){return[]}var Xt=Object.prototype.propertyIsEnumerable,te=Object.getOwnPropertySymbols,ee=te?function(e){return null==e?[]:(e=Object(e),function(t,e){for(var r=-1,i=null==t?0:t.length,n=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[n++]=o)}return s}(te(e),function(t){return Xt.call(e,t)}))}:Yt;function re(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}var ie=Bt(Object.getPrototypeOf,Object),ne=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)re(e,ee(t)),t=ie(t);return e}:Yt;function se(t,e,r){e=e(t);return St(t)?e:re(e,r(t))}function oe(t){return se(t,qt,ee)}function ae(t){return se(t,Vt,ne)}var D=ct(I,"DataView"),z=ct(I,"Promise"),M=ct(I,"Set"),st=ct(I,"WeakMap"),ce="[object Map]",ue="[object Promise]",le="[object Set]",pe="[object WeakMap]",he="[object DataView]",fe=it(D),de=it(ut),ye=it(z),be=it(M),ve=it(st),tt=q,ge=tt=D&&tt(new D(new ArrayBuffer(1)))!=he||ut&&tt(new ut)!=ce||z&&tt(z.resolve())!=ue||M&&tt(new M)!=le||st&&tt(new st)!=pe?function(t){var e=q(t),t="[object Object]"==e?t.constructor:void 0,t=t?it(t):"";if(t)switch(t){case fe:return he;case de:return ce;case ye:return ue;case be:return le;case ve:return pe}return e}:tt,_e=Object.prototype.hasOwnProperty;var me=I.Uint8Array;function je(t){var e=new t.constructor(t.byteLength);return new me(e).set(new me(t)),e}var we=/\w*$/;var I=L?L.prototype:void 0,Oe=I?I.valueOf:void 0;var ke="[object Boolean]",Ae="[object Date]",Pe="[object Map]",Ce="[object Number]",Se="[object RegExp]",Re="[object Set]",$e="[object String]",Ee="[object Symbol]",xe="[object ArrayBuffer]",Fe="[object DataView]",Te="[object Float32Array]",De="[object Float64Array]",ze="[object Int8Array]",Ie="[object Int16Array]",Le="[object Int32Array]",Me="[object Uint8Array]",Ue="[object Uint8ClampedArray]",Ne="[object Uint16Array]",Be="[object Uint32Array]";function Je(t,e,r){var i,n,s,o,a=t.constructor;switch(e){case xe:return je(t);case ke:case Ae:return new a(+t);case Fe:return s=t,o=(o=r)?je(s.buffer):s.buffer,new s.constructor(o,s.byteOffset,s.byteLength);case Te:case De:case ze:case Ie:case Le:case Me:case Ue:case Ne:case Be:return n=t,s=(s=r)?je(n.buffer):n.buffer,new n.constructor(s,n.byteOffset,n.length);case Pe:return new a;case Ce:case $e:return new a(t);case Se:return(i=new(n=t).constructor(n.source,we.exec(n))).lastIndex=n.lastIndex,i;case Re:return new a;case Ee:return i=t,Oe?Object(Oe.call(i)):{}}}var Ke=Object.create,We=function(t){if(!G(t))return{};if(Ke)return Ke(t);He.prototype=t;t=new He;return He.prototype=void 0,t};function He(){}var L=kt&&kt.isMap,qe=L?Tt(L):function(t){return wt(t)&&"[object Map]"==ge(t)};var I=kt&&kt.isSet,Ge=I?Tt(I):function(t){return wt(t)&&"[object Set]"==ge(t)},Ze=1,Ve=2,Qe=4,Ye="[object Arguments]",Xe="[object Function]",tr="[object GeneratorFunction]",er="[object Object]",rr={};function ir(r,i,n,t,e,s){var o,a=i&Ze,c=i&Ve,u=i&Qe;if(void 0!==(o=n?e?n(r,t,e,s):n(r):o))return o;if(!G(r))return r;var l,p,h,f,d,y=St(r);if(y){if(b=(f=r).length,d=new f.constructor(b),b&&"string"==typeof f[0]&&_e.call(f,"index")&&(d.index=f.index,d.input=f.input),o=d,!a)return function(t,e){var r=-1,i=t.length;for(e=e||Array(i);++r<i;)e[r]=t[r];return e}(r,o)}else{var t=ge(r),b=t==Xe||t==tr;if(Rt(r))return f=r,(d=a)?f.slice():(d=f.length,d=Qt?Qt(d):new f.constructor(d),f.copy(d),d);if(t==er||t==Ye||b&&!e){if(o=c||b?{}:"function"!=typeof(b=r).constructor||Nt(b)?{}:We(ie(b)),!a)return c?(h=l=r,h=(p=o)&&jt(h,Vt(h),p),jt(l,ne(l),h)):(l=p=r,h=(h=o)&&jt(l,qt(l),h),jt(p,ee(p),h))}else{if(!rr[t])return e?r:{};o=Je(r,t,a)}}a=(s=s||new bt).get(r);if(a)return a;s.set(r,o),Ge(r)?r.forEach(function(t){o.add(ir(t,i,n,t,r,s))}):qe(r)&&r.forEach(function(t,e){o.set(e,ir(t,i,n,e,r,s))});var v=y?void 0:(u?c?ae:oe:c?Vt:qt)(r);return function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&!1!==e(t[r],r,t););}(v||r,function(t,e){v&&(t=r[e=t]),mt(o,e,ir(t,i,n,e,r,s))}),o}rr[Ye]=rr["[object Array]"]=rr["[object ArrayBuffer]"]=rr["[object DataView]"]=rr["[object Boolean]"]=rr["[object Date]"]=rr["[object Float32Array]"]=rr["[object Float64Array]"]=rr["[object Int8Array]"]=rr["[object Int16Array]"]=rr["[object Int32Array]"]=rr["[object Map]"]=rr["[object Number]"]=rr[er]=rr["[object RegExp]"]=rr["[object Set]"]=rr["[object String]"]=rr["[object Symbol]"]=rr["[object Uint8Array]"]=rr["[object Uint8ClampedArray]"]=rr["[object Uint16Array]"]=rr["[object Uint32Array]"]=!0,rr["[object Error]"]=rr[Xe]=rr["[object WeakMap]"]=!1;function nr(t){return ir(t,5)}var kt=(function(t){t.exports=(t={},(t=function(){this.listeners={}}).prototype={addEventListener:function(t,e,r){for(var i=[],n=arguments.length,s=0;s<n;s++)i.push(arguments[s]);i=3<i.length?i.splice(3,i.length-1):[],void 0!==this.listeners[t]?this.listeners[t].push({scope:r,callback:e,args:i}):this.listeners[t]=[{scope:r,callback:e,args:i}]},removeEventListener:function(t,e,r){if(void 0!==this.listeners[t]){for(var i=this.listeners[t].length,n=[],s=0;s<i;s++){var o=this.listeners[t][s];o.scope==r&&o.callback==e||n.push(o)}this.listeners[t]=n}},hasEventListener:function(t,e,r){if(void 0!==this.listeners[t]){var i=this.listeners[t].length;if(void 0===e&&void 0===r)return 0<i;for(var n=0;n<i;n++){var s=this.listeners[t][n];if((!r||s.scope==r)&&s.callback==e)return!0}}return!1},dispatch:function(t,e){for(var e={type:t,target:e},r=[],i=arguments.length,n=0;n<i;n++)r.push(arguments[n]);if(r=2<r.length?r.splice(2,r.length-1):[],r=[e].concat(r),void 0!==this.listeners[t])for(var s=this.listeners[t].slice(),o=s.length,n=0;n<o;n++){var a,c=s[n];c&&c.callback&&(a=r.concat(c.args),c.callback.apply(c.scope,a))}},getEvents:function(){var t,e="";for(t in this.listeners)for(var r=this.listeners[t].length,i=0;i<r;i++){var n=this.listeners[t][i];e+=n.scope&&n.scope.className?n.scope.className:"anonymous",e+=" listen for '"+t+"'\n"}return e}},new t)}(L={exports:{}}),L.exports),sr=Object.freeze({default:kt,__moduleExports:kt}),or=(Object.defineProperty(ar.prototype,"count",{get:function(){return Object.keys(this.data).length},enumerable:!1,configurable:!0}),ar.prototype.find=function(t,e){return e=(e=void 0===e?null:e)||t.storeKey,this.data[e]},ar.prototype.findAll=function(t){var e=this,r=[];return t.forEach(function(t){t=e.find(t);t&&r.push(t)}),r},ar.prototype.create=function(t,e){t.storeKey=e,t.stale=!1,this.data[e]=nr(t.attributes)},ar.prototype.updateOrCreate=function(t){var e;t.storeKey?this.create(t,t.storeKey):(e=this.keyFor(t),this.create(t,e)),sr.dispatch(t.storeKey,{},this.data[t.storeKey])},ar.prototype.destroy=function(t){t.stale=!0,delete this.data[t.storeKey]},ar.prototype.keyFor=function(t){return t.klass.jsonapiType+"-"+t.id},ar);function ar(){this.data={}}var cr=(ur.prototype.addResources=function(t){if(t)if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._resources.push(i)}else this._resources.push(t)},ur.prototype.instanceFor=function(t){var e=this.registry.get(t);if(!e)throw new Error('Unknown type "'+t+'"');return new e},ur.prototype.relationshipInstanceFor=function(e,t){return t.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e["temp-id"]&&t.temp_id===e["temp-id"]))})||this.instanceFor(e.type)},ur.prototype.lookupAssociated=function(t,e){return t.find(function(t){return!(t.klass.jsonapiType!==e.klass.jsonapiType||!(t.temp_id&&e.temp_id&&t.temp_id===e.temp_id||t.id&&e.id&&t.id===e.id))})},ur.prototype.pushRelation=function(t,e,r){var i=t,t=i[e];this.lookupAssociated(t,r)||i[e].push(r)},ur.prototype.deserialize=function(t){var e=this.instanceFor(t.type);return this.deserializeInstance(e,t,{})},ur.prototype.deserializeInstance=function(t,e,r){void 0===r&&(r={});var i=this.alreadyDeserialized(e);return i||(t.id=e.id,t.temp_id=e["temp-id"],t.assignAttributes(e.attributes),t.assignLinks(e.links),t.setMeta(e.meta,!1),this._deserialized.push(t),this._processRelationships(t,e.relationships||{},r),this._removeDeletions(t,r),t.isPersisted=!0,t.reset(),t)},ur.prototype._removeDeletions=function(e,n){var s=this;Object.keys(n).forEach(function(r){var i=e,t=i[r];t&&(Array.isArray(t)?t.forEach(function(t,e){t.isMarkedForDestruction?i.klass.store.destroy(t):t.isMarkedForDisassociation?i[r].splice(e,1):s._removeDeletions(t,n[r]||{})}):(t=t).isMarkedForDestruction?i.klass.store.destroy(t):t.isMarkedForDisassociation?i[r]=null:s._removeDeletions(t,n[r]||{}))})},ur.prototype._processRelationships=function(u,t,l){var p=this;this._iterateValidRelationships(u,t,function(t,e){var r=l[t],i=u;if(Array.isArray(e))for(var n=0,s=e;n<s.length;n++){var o=s[n],a=p.findResource(o),o=i[t],o=p.relationshipInstanceFor(a,o),o=p.deserializeInstance(o,a,r);p.pushRelation(u,t,o)}else{var a=p.findResource(e),c=i[t],e=c||p.instanceFor(a.type),e=p.deserializeInstance(e,a,r);c||(i[t]=e)}})},ur.prototype._iterateValidRelationships=function(t,e,r){for(var i in e){var n;e.hasOwnProperty(i)&&(n=t.klass.deserializeKey(i),!t.klass.attributeList[n]||(i=e[i].data)&&r(n,i))}},ur.prototype.alreadyDeserialized=function(e){return this._deserialized.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e.temp_id&&t.temp_id===e["temp-id"]))})},ur.prototype.findResource=function(e){return this._resources.find(function(t){return!(t.type!==e.type||!(t.id&&e.id&&t.id===e.id||t["temp-id"]&&e["temp-id"]&&t["temp-id"]===e["temp-id"]))})||e},ur);function ur(t,e){this._deserialized=[],this._resources=[],this.registry=t,this.payload=e,this.addResources(e.data),this.addResources(e.included)}var lr=Object.prototype.hasOwnProperty;var pr=(hr.prototype.checkRelation=function(t,e){var r=!1;return e.isPersisted&&((this.model._originalRelationships[t]||[]).find(function(t){return JSON.stringify(t)===JSON.stringify(e.resourceIdentifier)})||(r=!0)),r},hr.prototype.check=function(t){t=new m(t=void 0===t?{}:t).toScopeObject();return this._hasDirtyAttributes()||this._hasDirtyRelationships(t)||this.model.isMarkedForDestruction||this.model.isMarkedForDisassociation||this._isUnpersisted()},hr.prototype.dirtyAttributes=function(){for(var t={},e=0,r=Object.keys(this.model.attributes);e<r.length;e++){var i=r[e],n=this.model._originalAttributes[i],s=this.model.attributes[i],o=this.model.klass.attributeList[i];this.model.isPersisted?o.dirtyChecker(n,s)&&(t[i]=[n,s]):t[i]=[null,s]}return t},hr.prototype._isUnpersisted=function(){return!this.model.isPersisted&&JSON.stringify(this.model.attributes)!==JSON.stringify({})},hr.prototype._hasDirtyAttributes=function(){return!function(t){if(null==t)return 1;if(Ht(t)&&(St(t)||"string"==typeof t||"function"==typeof t.splice||Rt(t)||It(t)||Ct(t)))return!t.length;var e,r=ge(t);if("[object Map]"==r||"[object Set]"==r)return!t.size;if(Nt(t))return!Wt(t).length;for(e in t)if(lr.call(t,e))return;return 1}(this.dirtyAttributes())},hr.prototype._hasDirtyRelationships=function(t){var i=this,n=!1;return this._eachRelatedObject(t,function(t,e,r){e.isDirty(r)&&(n=!0),i.checkRelation(t,e)&&(n=!0)}),n},hr.prototype._eachRelatedObject=function(i,n){var s=this;Object.keys(i).forEach(function(e){var r=i[e],t=s.model[e];(t=!Array.isArray(t)?[t]:t).forEach(function(t){t&&n(e,t,r)})})},hr);function hr(t){this.model=t}function fr(t,e){var r,i,n=[];for(r in t)!t.hasOwnProperty(r)||null!=(i=t[r])&&""!==i&&(e&&(r=e+"["+r+"]"),Array.isArray(i)?0<(i=i.map(dr)).length&&n.push(r+"="+i.join(",")):"object"==typeof i?n.push(fr(i,r)):n.push(r+"="+dr(i)));return(n=n.filter(function(t){return!!t})).join("&")}function dr(t){var e="undefined"!=typeof window&&void 0!==window.navigator.userAgent,r=e&&window.navigator.userAgent.match(/(MSIE|Trident)/),i="string"==typeof t&&-1!==t.indexOf("%");return e&&r&&!i?encodeURIComponent(t):t}var yr=(Object.defineProperty(br.prototype,"raw",{get:function(){return this._raw_json},enumerable:!1,configurable:!0}),Object.defineProperty(br.prototype,"data",{get:function(){return this._collection},enumerable:!1,configurable:!0}),Object.defineProperty(br.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!1,configurable:!0}),br);function br(t,e){void 0===e&&(e={data:[]}),this._collection=t,this._raw_json=e}var vr=(Object.defineProperty(gr.prototype,"raw",{get:function(){return this._raw_json},enumerable:!1,configurable:!0}),Object.defineProperty(gr.prototype,"data",{get:function(){return this._record},enumerable:!1,configurable:!0}),Object.defineProperty(gr.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!1,configurable:!0}),gr);function gr(t,e){this._record=t,this._raw_json=e}var _r=(Object.defineProperty(mr.prototype,"raw",{get:function(){return this._raw_json},enumerable:!1,configurable:!0}),Object.defineProperty(mr.prototype,"data",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(mr.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!1,configurable:!0}),mr);function mr(t){this._raw_json=t}var jr=(wr.prototype.all=function(){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url())];case 1:return e=t.sent(),[2,this._buildCollectionResult(e)]}})})},wr.prototype.find=function(r){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url(r))];case 1:return e=t.sent(),[2,this._buildRecordResult(e)]}})})},wr.prototype.first=function(){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,(e=this.per(1))._fetch(e.model.url())];case 1:return e=t.sent(),[2,this._buildRecordResult(e)]}})})},wr.prototype.merge=function(r){var i=this,n=this.copy();return Object.keys(r).forEach(function(t){var e=i.model.serializeKey(t);n._associations[e]=r[t]}),n},wr.prototype.page=function(t){var e=this.copy();return e._pagination.number=t,e},wr.prototype.per=function(t){var e=this.copy();return e._pagination.size=t,e},wr.prototype.where=function(t){var e,r=this.copy();for(e in t=this._serverCasedWhereClause(t))t.hasOwnProperty(e)&&(r._filter[e]=t[e]);return r},wr.prototype.extraParams=function(t){var e,r=this.copy();for(e in t)t.hasOwnProperty(e)&&(r._extraParams[e]=t[e]);return r},wr.prototype.stats=function(t){var e,r=this.copy();for(e in t=this._serverCasedStatsClause(t))t.hasOwnProperty(e)&&(r._stats[e]=t[e]);return r},wr.prototype.order=function(t){var e=this.copy();if("object"==typeof(t=this._serverCasedOrderClause(t)))for(var r in t)t.hasOwnProperty(r)&&(e._sort[r]=t[r]);else e._sort[t]="asc";return e},wr.prototype.select=function(t){var e=this.copy();if(t=this._serverCasedFieldsClause(t),Array.isArray(t)){var r=t,i=this.model.jsonapiType;e._fields[i]=r}else for(var n in t)t.hasOwnProperty(n)&&(e._fields[n]=t[n]);return e},wr.prototype.selectExtra=function(t){var e=this.copy();if(t=this._serverCasedFieldsClause(t),Array.isArray(t)){var r=t,i=this.model.jsonapiType;e._extra_fields[i]=r}else for(var n in t)t.hasOwnProperty(n)&&(e._extra_fields[n]=t[n]);return e},wr.prototype.includes=function(t){var e=this.copy();t=this._serverCasedIncludesClause(t);var r,i=new m(t).toScopeObject();for(r in i)i.hasOwnProperty(r)&&(e._include[r]=i[r]);return e},wr.prototype.extraFetchOptions=function(t){var e,r=this.copy();for(e in t)t.hasOwnProperty(e)&&(r._extraFetchOptions[e]=t[e]);return r},wr.prototype.scope=function(){return this},wr.prototype.asQueryParams=function(){var e=this,r={page:this._pagination,filter:this._filter,sort:this._sortParam(this._sort)||[],fields:this._fields,extra_fields:this._extra_fields,stats:this._stats,include:new m(this._include).toString()};return this._mergeAssociationQueryParams(r,this._associations),Object.keys(this._extraParams).forEach(function(t){r[t]=e._extraParams[t]}),r},wr.prototype.toQueryParams=function(){var t=fr(this.asQueryParams());if(""!==t)return t},wr.prototype.fetchOptions=function(){return n(n({},this.model.fetchOptions()),this._extraFetchOptions)},wr.prototype.copy=function(){return nr(this)},wr.prototype._mergeAssociationQueryParams=function(r,i){var t,n=this;for(t in i)!function(e){var t;i.hasOwnProperty(e)&&(t=i[e].asQueryParams(),r.page[e]=t.page,r.filter[e]=t.filter,r.stats[e]=t.stats,Object.assign(r.fields,t.fields),Object.assign(r.extra_fields,t.extra_fields),t.sort.forEach(function(t){t=n._transformAssociationSortParam(e,t);r.sort.push(t)}))}(t)},wr.prototype._transformAssociationSortParam=function(t,e){return-1!==e.indexOf("-")&&(e=e.replace("-",""),t="-"+t),t+"."+e},wr.prototype._sortParam=function(t){if(t&&0<Object.keys(t).length){var e,r=[];for(e in t)t.hasOwnProperty(e)&&("asc"!==t[e]&&(e="-"+e),r.push(e));return r}},wr.prototype._fetch=function(r){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return(e=this.toQueryParams())&&(r=r+"?"+e),[4,new h(this.model.middlewareStack,this.model.logger).get(r,this.fetchOptions())];case 1:return e=t.sent(),a(this.model,e),[2,e.jsonPayload]}})})},wr.prototype._buildRecordResult=function(t){var e;if(t.data instanceof Array){if(!(e=t.data[0]))return new _r(t)}else e=t.data;return e=this.model.fromJsonapi(e,t),new vr(e,t)},wr.prototype._buildCollectionResult=function(e){var r=this,i=[];return e.data.forEach(function(t){i.push(r.model.fromJsonapi(t,e))}),new yr(i,e)},wr.prototype._serverCasedWhereClause=function(t){return this._serverCasedClause(t,!1)},wr.prototype._serverCasedOrderClause=function(t){return"string"==typeof t?this._serverCasedClause(t,!0):this._serverCasedClause(t,!1)},wr.prototype._serverCasedFieldsClause=function(t){return this._serverCasedClause(t,!0)},wr.prototype._serverCasedIncludesClause=function(t){return this._serverCasedClause(t,!0)},wr.prototype._serverCasedStatsClause=function(t){return this._serverCasedClause(t,!0)},wr.prototype._serverCasedClause=function(t,e){var r=this;if(void 0===e&&(e=!1),"string"==typeof t)return e?this.model.serializeKey(t):t;if(t instanceof Array)return t.map(function(t){return r._serverCasedClause(t,e)});if(t instanceof Object){var i,n,s,o={};for(i in t)t.hasOwnProperty(i)&&(n=this.model.serializeKey(i),s=this._serverCasedClause(t[i],e),o[n]=s);return o}return t},wr);function wr(t){this._associations={},this._pagination={},this._filter={},this._sort={},this._fields={},this._extra_fields={},this._include={},this._stats={},this._extraParams={},this._extraFetchOptions={},this.model=t}var Or=(kr.prototype.register=function(t,e){if(this._typeMap[t])throw new Error('Type "'+t+'" already registered on base class '+this._baseClass);this._typeMap[t]=e},kr.prototype.get=function(t){return this._typeMap[t]},kr);function kr(t){this._typeMap={},this._baseClass=t}var Ar=Object.prototype.toString;function Pr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}I=function(t,e,r){return e&&Cr(t.prototype,e),r&&Cr(t,r),t};function Cr(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Sr(t){return t.split("").map(function(t){return"(?:"+t.toUpperCase()+"|"+t.toLowerCase()+")"}).join("")}function Rr(t,e){for(var r=t.length-1;0<=r;r--)t[r]===e&&Array.prototype.splice.call(t,r,1)}var $r={},Er=(I(xr,null,[{key:"getInstance",value:function(t){return $r[t]=$r[t]||new xr,$r[t]}}]),I(xr,[{key:"acronym",value:function(t){this.acronyms[t.toLowerCase()]=t;var e,r,i,n=[];for(e in this.acronyms)r=this.acronyms,i=e,Object.prototype.hasOwnProperty.call(r,i)&&n.push(this.acronyms[e]);this.acronymRegex=new RegExp(n.join("|"))}},{key:"plural",value:function(t,e){"string"==typeof t&&Rr(this.uncountables,t),Rr(this.uncountables,e),this.plurals.unshift([t,e])}},{key:"singular",value:function(t,e){"string"==typeof t&&Rr(this.uncountables,t),Rr(this.uncountables,e),this.singulars.unshift([t,e])}},{key:"irregular",value:function(t,e){Rr(this.uncountables,t),Rr(this.uncountables,e);var r=t[0],i=t.substr(1),n=e[0],s=e.substr(1);r.toUpperCase()===n.toUpperCase()?(this.plural(new RegExp("("+r+")"+i+"$","i"),"$1"+s),this.plural(new RegExp("("+n+")"+s+"$","i"),"$1"+s),this.singular(new RegExp("("+r+")"+i+"$","i"),"$1"+i),this.singular(new RegExp("("+n+")"+s+"$","i"),"$1"+i)):(t=Sr(i),e=Sr(s),this.plural(new RegExp(r.toUpperCase()+t+"$"),n.toUpperCase()+s),this.plural(new RegExp(r.toLowerCase()+t+"$"),n.toLowerCase()+s),this.plural(new RegExp(n.toUpperCase()+e+"$"),n.toUpperCase()+s),this.plural(new RegExp(n.toLowerCase()+e+"$"),n.toLowerCase()+s),this.singular(new RegExp(r.toUpperCase()+t+"$"),r.toUpperCase()+i),this.singular(new RegExp(r.toLowerCase()+t+"$"),r.toLowerCase()+i),this.singular(new RegExp(n.toUpperCase()+e+"$"),r.toUpperCase()+i),this.singular(new RegExp(n.toLowerCase()+e+"$"),r.toLowerCase()+i))}},{key:"uncountable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.uncountables=this.uncountables.concat(e)}},{key:"human",value:function(t,e){this.humans.unshift([t,e])}},{key:"clear",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";"all"===t?(this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[]):this[t]=[]}}]),xr);function xr(){Pr(this,xr),this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[],this.acronyms={},this.acronymRegex=/(?=a)b/}var Fr,Tr={en:function(t){t.plural(/$/,"s"),t.plural(/s$/i,"s"),t.plural(/^(ax|test)is$/i,"$1es"),t.plural(/(octop|vir)us$/i,"$1i"),t.plural(/(octop|vir)i$/i,"$1i"),t.plural(/(alias|status)$/i,"$1es"),t.plural(/(bu)s$/i,"$1ses"),t.plural(/(buffal|tomat)o$/i,"$1oes"),t.plural(/([ti])um$/i,"$1a"),t.plural(/([ti])a$/i,"$1a"),t.plural(/sis$/i,"ses"),t.plural(/(?:([^f])fe|([lr])f)$/i,"$1$2ves"),t.plural(/(hive)$/i,"$1s"),t.plural(/([^aeiouy]|qu)y$/i,"$1ies"),t.plural(/(x|ch|ss|sh)$/i,"$1es"),t.plural(/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"),t.plural(/^(m|l)ouse$/i,"$1ice"),t.plural(/^(m|l)ice$/i,"$1ice"),t.plural(/^(ox)$/i,"$1en"),t.plural(/^(oxen)$/i,"$1"),t.plural(/(quiz)$/i,"$1zes"),t.singular(/s$/i,""),t.singular(/(ss)$/i,"$1"),t.singular(/(n)ews$/i,"$1ews"),t.singular(/([ti])a$/i,"$1um"),t.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1sis"),t.singular(/(^analy)(sis|ses)$/i,"$1sis"),t.singular(/([^f])ves$/i,"$1fe"),t.singular(/(hive)s$/i,"$1"),t.singular(/(tive)s$/i,"$1"),t.singular(/([lr])ves$/i,"$1f"),t.singular(/([^aeiouy]|qu)ies$/i,"$1y"),t.singular(/(s)eries$/i,"$1eries"),t.singular(/(m)ovies$/i,"$1ovie"),t.singular(/(x|ch|ss|sh)es$/i,"$1"),t.singular(/^(m|l)ice$/i,"$1ouse"),t.singular(/(bus)(es)?$/i,"$1"),t.singular(/(o)es$/i,"$1"),t.singular(/(shoe)s$/i,"$1"),t.singular(/(cris|test)(is|es)$/i,"$1is"),t.singular(/^(a)x[ie]s$/i,"$1xis"),t.singular(/(octop|vir)(us|i)$/i,"$1us"),t.singular(/(alias|status)(es)?$/i,"$1"),t.singular(/^(ox)en/i,"$1"),t.singular(/(vert|ind)ices$/i,"$1ex"),t.singular(/(matr)ices$/i,"$1ix"),t.singular(/(quiz)zes$/i,"$1"),t.singular(/(database)s$/i,"$1"),t.irregular("person","people"),t.irregular("man","men"),t.irregular("child","children"),t.irregular("sex","sexes"),t.irregular("move","moves"),t.irregular("zombie","zombies"),t.uncountable("equipment","information","rice","money","species","series","fish","sheep","jeans","police")}};function Dr(t,e){var r;if(r=t,"[object Function]"===Ar.call(r)&&(e=t,t=null),t=t||"en",!e)return Er.getInstance(t);e(Er.getInstance(t))}for(Fr in Tr)Dr(Fr,Tr[Fr]);function zr(t,e){return function(t,e){var r,i,n=""+t;if(0===n.length)return n;if((t=n.toLowerCase().match(/\b\w+$/))&&-1<Dr().uncountables.indexOf(t[0]))return n;for(var s=0,o=e.length;s<o;s++)if(r=(i=e[s])[0],i=i[1],n.match(r)){n=n.replace(r,i);break}return n}(t,Dr(1<arguments.length&&void 0!==e?e:"en").plurals)}function Ir(t){t=null==t?"":String(t);return t.charAt(0).toUpperCase()+t.slice(1)}function Lr(t,e){var t=""+t;return t=(t=(e=null==e?!0:e)?t.replace(/^[a-z\d]*/,function(t){return Dr().acronyms[t]||Ir(t)}):t.replace(new RegExp("^(?:"+Dr().acronymRegex.source+"(?=\\b|[A-Z_])|\\w)"),function(t){return t.toLowerCase()})).replace(/(?:_|(\/))([a-z\d]*)/gi,function(t,e,r,i,n){return""+(e=e||"")+(Dr().acronyms[r]||Ir(r))})}function Mr(t){var t=""+t;return(t=(t=(t=(t=t.replace(new RegExp("(?:([A-Za-z\\d])|^)("+Dr().acronymRegex.source+")(?=\\b|[^a-z])","g"),function(t,e,r){return(e||"")+(e?"_":"")+r.toLowerCase()})).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2")).replace(/([a-z\d])([A-Z])/g,"$1_$2")).replace(/-/g,"_")).toLowerCase()}function Ur(t){return t.replace(/_/g,"-")}var Nr,Br={"Ã€":"A","Ã":"A","Ã‚":"A","Ãƒ":"A","Ã„":"A","Ã…":"A","Ã†":"AE","Ã‡":"C","Ãˆ":"E","Ã‰":"E","ÃŠ":"E","Ã‹":"E","ÃŒ":"I","Ã":"I","ÃŽ":"I","Ã":"I","Ã":"D","Ã‘":"N","Ã’":"O","Ã“":"O","Ã”":"O","Ã•":"O","Ã–":"O","Ã—":"x","Ã˜":"O","Ã™":"U","Ãš":"U","Ã›":"U","Ãœ":"U","Ã":"Y","Ãž":"Th","ÃŸ":"ss","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã¦":"ae","Ã§":"c","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã°":"d","Ã±":"n","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã½":"y","Ã¾":"th","Ã¿":"y","Ä€":"A","Ä":"a","Ä‚":"A","Äƒ":"a","Ä„":"A","Ä…":"a","Ä†":"C","Ä‡":"c","Äˆ":"C","Ä‰":"c","ÄŠ":"C","Ä‹":"c","ÄŒ":"C","Ä":"c","ÄŽ":"D","Ä":"d","Ä":"D","Ä‘":"d","Ä’":"E","Ä“":"e","Ä”":"E","Ä•":"e","Ä–":"E","Ä—":"e","Ä˜":"E","Ä™":"e","Äš":"E","Ä›":"e","Äœ":"G","Ä":"g","Äž":"G","ÄŸ":"g","Ä ":"G","Ä¡":"g","Ä¢":"G","Ä£":"g","Ä¤":"H","Ä¥":"h","Ä¦":"H","Ä§":"h","Ä¨":"I","Ä©":"i","Äª":"I","Ä«":"i","Ä¬":"I","Ä­":"i","Ä®":"I","Ä¯":"i","Ä°":"I","Ä±":"i","Ä²":"IJ","Ä³":"ij","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Äº":"l","Ä»":"L","Ä¼":"l","Ä½":"L","Ä¾":"l","Ä¿":"L","Å€":"l","Å":"L","Å‚":"l","Åƒ":"N","Å„":"n","Å…":"N","Å†":"n","Å‡":"N","Åˆ":"n","Å‰":"'n","ÅŠ":"NG","Å‹":"ng","ÅŒ":"O","Å":"o","ÅŽ":"O","Å":"o","Å":"O","Å‘":"o","Å’":"OE","Å“":"oe","Å”":"R","Å•":"r","Å–":"R","Å—":"r","Å˜":"R","Å™":"r","Åš":"S","Å›":"s","Åœ":"S","Å":"s","Åž":"S","ÅŸ":"s","Å ":"S","Å¡":"s","Å¢":"T","Å£":"t","Å¤":"T","Å¥":"t","Å¦":"T","Å§":"t","Å¨":"U","Å©":"u","Åª":"U","Å«":"u","Å¬":"U","Å­":"u","Å®":"U","Å¯":"u","Å°":"U","Å±":"u","Å²":"U","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Åº":"z","Å»":"Z","Å¼":"z","Å½":"Z","Å¾":"z","Ð":"A","Ð‘":"B","Ð’":"V","Ð“":"G","Ð”":"D","Ð•":"E","Ð":"E","Ð–":"ZH","Ð—":"Z","Ð˜":"I","Ð™":"J","Ðš":"K","Ð›":"L","Ðœ":"M","Ð":"N","Ðž":"O","ÐŸ":"P","Ð ":"R","Ð¡":"S","Ð¢":"T","Ð£":"U","Ð¤":"F","Ð¥":"KH","Ð¦":"C","Ð§":"CH","Ð¨":"SH","Ð©":"SHCH","Ðª":"","Ð«":"Y","Ð¬":"","Ð­":"E","Ð®":"YU","Ð¯":"YA","Ð°":"a","Ð±":"b","Ð²":"v","Ð³":"g","Ð´":"d","Ðµ":"e","Ñ‘":"e","Ð¶":"zh","Ð·":"z","Ð¸":"i","Ð¹":"j","Ðº":"k","Ð»":"l","Ð¼":"m","Ð½":"n","Ð¾":"o","Ð¿":"p","Ñ€":"r","Ñ":"s","Ñ‚":"t","Ñƒ":"u","Ñ„":"f","Ñ…":"kh","Ñ†":"c","Ñ‡":"ch","Ñˆ":"sh","Ñ‰":"shch","ÑŠ":"","Ñ‹":"y","ÑŒ":"","Ñ":"e","ÑŽ":"yu","Ñ":"ya"},Jr={};I(Kr,null,[{key:"getInstance",value:function(t){return Jr[t]=Jr[t]||new Kr,Jr[t]}}]),I(Kr,[{key:"approximate",value:function(t,e){this.approximations[t]=e}},{key:"transliterate",value:function(t,e){var r=this;return t.replace(/[^\u0000-\u007f]/g,function(t){return r.approximations[t]||e||"?"})}}]);function Kr(){for(var t in Pr(this,Kr),this.approximations={},Br)this.approximate(t,Br[t])}(L=Nr=Nr||{})[L.debug=1]="debug",L[L.info=2]="info",L[L.warn=3]="warn",L[L.error=4]="error";var Wr={debug:1,info:2,warn:3,error:4};function Hr(t){void 0===t&&(t="warn"),this._level=Nr.info,"number"==typeof t?this._level=t:this.level=t}var qr=new(Hr.prototype.debug=function(t){this._level<=Nr.debug&&console.info(t)},Hr.prototype.info=function(t){this._level<=Nr.info&&console.info(t)},Hr.prototype.warn=function(t){this._level<=Nr.warn&&console.warn(t)},Hr.prototype.error=function(t){this._level<=Nr.warn&&console.error(t)},Object.defineProperty(Hr.prototype,"level",{get:function(){for(var t in Nr)if(Nr.hasOwnProperty(t))if(Nr[t]===this._level)return t;throw new Error("Invalid log level: "+this._level)},set:function(t){t=Nr[t];if(!t)throw new Error("Log level must be one of "+Object.keys(Wr).join(", "));this._level=t},enumerable:!1,configurable:!0}),Hr);function Gr(r,i){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<r.length?[4,i(r[e],e,r)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e+=1,[3,1];case 4:return[2]}})})}var Zr=(Object.defineProperty(Vr.prototype,"beforeFilters",{get:function(){return this._beforeFilters},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"afterFilters",{get:function(){return this._afterFilters},enumerable:!1,configurable:!0}),Vr.prototype.beforeFetch=function(i,n){return s(this,void 0,void 0,function(){var r=this;return u(this,function(t){switch(t.label){case 0:return[4,Gr(this._beforeFilters,function(e){return s(r,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,e(i,n)];case 1:return t.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},Vr.prototype.afterFetch=function(i,n){return s(this,void 0,void 0,function(){var r=this;return u(this,function(t){switch(t.label){case 0:return[4,Gr(this._afterFilters,function(e){return s(r,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,e(i,n)];case 1:return t.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},Vr);function Vr(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this._beforeFilters=[],this._afterFilters=[],this._beforeFilters=t,this._afterFilters=e}function Qr(t,e){Object.defineProperty(t,e,{get:function(){},set:function(t){Object.defineProperty(this,e,{value:t,writable:!0,configurable:!0,enumerable:!1})},configurable:!0,enumerable:!1})}var Yr=function(t,e){for(var r in(e=n({},e)).credentialStorageBackend&&(t.credentialStorageBackend=e.credentialStorageBackend,delete e.jwtStorage),e.jwtStorage&&(t.jwtStorage=e.jwtStorage,delete e.jwtStorage),e.jwt&&(t.setJWT(e.jwt),delete e.jwt),e)e.hasOwnProperty(r)&&(t[r]=e[r]);void 0===t.isBaseClass?t.setAsBase():!0===t.isBaseClass&&(t.isBaseClass=!1)},Xr=(Object.defineProperty(ti,"credentialStorage",{get:function(){return this._credentialStorage},enumerable:!1,configurable:!0}),Object.defineProperty(ti,"jwtStorage",{get:function(){return this._jwtStorage},set:function(t){t!==this._jwtStorage&&(this._jwtStorage=t,this.credentialStorageBackend=this._credentialStorageBackend)},enumerable:!1,configurable:!0}),Object.defineProperty(ti,"credentialStorageBackend",{get:function(){return this._credentialStorageBackend},set:function(t){this._credentialStorageBackend=t,this._credentialStorage=new R(this.jwtStorage||"jwt",this._credentialStorageBackend)},enumerable:!1,configurable:!0}),ti.initializeCredentialStorage=function(){this.jwtStorage&&"undefined"!=typeof localStorage?this.credentialStorageBackend=localStorage:this.credentialStorageBackend=new C},ti.fromJsonapi=function(t,e){return r=this.typeRegistry,t=t,new cr(r,e).deserialize(t);var r},ti.inherited=function(t){t.parentClass=this,((t.currentClass=t).prototype.klass=t).attributeList=nr(t.attributeList),t.linkList=nr(t.linkList)},ti.setAsBase=function(){this.isBaseClass=!0,this.jsonapiType=void 0,this.typeRegistry||(this.typeRegistry=new Or(this)),this.middlewareStack||(this._middlewareStack=new Zr),this._IDMap||(this._IDMap=new or)},ti.isSubclassOf=function(t){for(var e=this.currentClass;e;){if(e===t)return!0;e=e.parentClass}return!1},Object.defineProperty(ti,"baseClass",{get:function(){for(var t=this.currentClass;t;){if(t.isBaseClass)return t;t=t.parentClass}},enumerable:!1,configurable:!0}),Object.defineProperty(ti,"store",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._IDMap},enumerable:!1,configurable:!0}),Object.defineProperty(ti,"typeRegistry",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._typeRegistry},set:function(t){if(!this.isBaseClass)throw new Error("Cannot set a registry on a non-base class");this._typeRegistry=t},enumerable:!1,configurable:!0}),ti.registerType=function(){var t;this.jsonapiType&&((t=this.typeRegistry.get(this.jsonapiType))&&this.isSubclassOf(t)||this.typeRegistry.register(this.jsonapiType,this))},ti.extend=function(t){var e,r=(c(i,e=this),i);function i(){return null!==e&&e.apply(this,arguments)||this}this.inherited(r);var n,s={};if(t.attrs)for(var o in t.attrs)t.attrs.hasOwnProperty(o)&&((n=t.attrs[o]).name||(n.name=o),n.owner=r,s[o]=n);if(r.attributeList=Object.assign({},r.attributeList,s),r.linkList=r.linkList.slice(),Yr(r,t.static||{}),r.registerType(),t.methods)for(var a in t.methods)t.methods.hasOwnProperty(a)&&(r.prototype[a]=t.methods[a]);return r},ti.prototype._initializeAttributes=function(){this._attributes={},this._copyPrototypeDescriptors()},ti.prototype._initializeLinks=function(){this._links={}},ti.prototype._copyPrototypeDescriptors=function(){var t,e,r=this,i=this.klass.attributeList;for(t in i)i.hasOwnProperty(t)&&(e=i[t],Object.defineProperty(this,t,e.descriptor()));["errors","isPersisted","isMarkedForDestruction","isMarkedForDisassociation"].forEach(function(t){var e=Object.getOwnPropertyDescriptor(ti.prototype,t);e&&Object.defineProperty(r,t,e)})},ti.prototype.isType=function(t){return this.klass.jsonapiType===t},Object.defineProperty(ti.prototype,"isPersisted",{get:function(){return this._persisted},set:function(t){(this._persisted=t)&&this.reset()},enumerable:!1,configurable:!0}),ti.prototype.onSyncRelationships=function(){var r=this;return this._onSyncRelationships||(this._onSyncRelationships=function(t,e){r.relationships=e},this._onSyncRelationships)},ti.prototype.onStoreChange=function(){var s=this;return this._onStoreChange||(this._onStoreChange=function(t,i){var n={};Object.keys(i).forEach(function(t){var e=s,r=s.changes();s.klass.attributeList[t].dirtyChecker(e[t],i[t])&&!r[t]&&(n[t]=[e[t],i[t]],e[t]=i[t],e._originalAttributes[t]=i[t])}),0<Object.keys(n).length&&void 0!==s.afterSync&&s.afterSync(n)},this._onStoreChange)},ti.prototype.unlisten=function(){var e=this;this.klass.sync&&(this.storeKey&&(sr.removeEventListener(this.storeKey,this.onStoreChange()),sr.removeEventListener(this.storeKey+"-sync-relationships",this.onSyncRelationships())),Object.keys(this.relationships).forEach(function(t){t=e.relationships[t];t&&(Array.isArray(t)?t.forEach(function(t){return t.unlisten()}):t.unlisten())}))},ti.prototype.listen=function(){this.klass.sync&&(this._onStoreChange||(sr.addEventListener(this.storeKey,this.onStoreChange()),sr.addEventListener(this.storeKey+"-sync-relationships",this.onSyncRelationships())))},ti.prototype.syncRelationships=function(){sr.dispatch(this.storeKey+"-sync-relationships",{},this.relationships)},ti.prototype.reset=function(){this.klass.sync&&(this.klass.store.updateOrCreate(this),this.listen()),this._originalAttributes=nr(this._attributes),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))},ti.prototype.rollback=function(){this._attributes=nr(this._originalAttributes)},Object.defineProperty(ti.prototype,"isMarkedForDestruction",{get:function(){return this._markedForDestruction},set:function(t){this._markedForDestruction=t},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"isMarkedForDisassociation",{get:function(){return this._markedForDisassociation},set:function(t){this._markedForDisassociation=t},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"attributes",{get:function(){return this._attributes},set:function(t){this._attributes={},this.assignAttributes(t)},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"stored",{get:function(){return this.klass.store.find(this)},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"typedAttributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),ti.prototype.relationship=function(t){return this.relationships[t]},ti.prototype.assignAttributes=function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){var r=this.klass.deserializeKey(e);if("id"===e||this.klass.attributeList[r])this[r]=t[e];else if(this.klass.strictAttributes)throw new Error("Unknown attribute: "+e)}},ti.prototype.setMeta=function(t,e){void 0===e&&(e=!0),this.__meta__=t,e&&(this._metaDirty=!0)},Object.defineProperty(ti.prototype,"meta",{get:function(){return this.__meta__||{}},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"isMetaDirty",{get:function(){return this._metaDirty},enumerable:!1,configurable:!0}),ti.prototype.relationshipResourceIdentifiers=function(t){return r=this,i={},t.forEach(function(e){var t=r.relationship(e);t&&(t=!Array.isArray(t)?[t]:t).forEach(function(t){t.isPersisted&&(i[e]||(i[e]=[]),i[e].push(t.resourceIdentifier))})}),i;var r,i},ti.prototype.fromJsonapi=function(t,e,r){return i=t,void 0===(t=r=void 0===r?{}:r)&&(t={}),new cr((r=this).klass.typeRegistry,e).deserializeInstance(r,i,t);var i},Object.defineProperty(ti.prototype,"resourceIdentifier",{get:function(){if(void 0===this.klass.jsonapiType)throw new Error("Cannot build resource identifier for class. No JSONAPI Type specified.");return{id:this.id,type:this.klass.jsonapiType}},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"errors",{get:function(){return this._errors},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),Object.defineProperty(ti.prototype,"hasError",{get:function(){return!!Object.keys(this._errors).length},enumerable:!1,configurable:!0}),ti.prototype.clearErrors=function(){this.errors={}},ti.prototype.isDirty=function(t){return new pr(this).check(t)},ti.prototype.changes=function(){return new pr(this).dirtyAttributes()},ti.prototype.hasDirtyRelation=function(t,e){var r=new pr(this);return!this.isPersisted||r.checkRelation(t,e)},ti.prototype.dup=function(){var t=Object.assign({},this.attributes,this.relationships),t=new this.klass(t);return t.id=this.id,t.isPersisted=this.isPersisted,t.isMarkedForDestruction=this.isMarkedForDestruction,t.isMarkedForDisassociation=this.isMarkedForDisassociation,t.errors=Object.assign({},this.errors),t.links=Object.assign({},this.links),t},ti.fetchOptions=function(){var t={credentials:"same-origin",headers:((e={Accept:"application/vnd.api+json"})["Content-Type"]="application/vnd.api+json",e)};this.credentials&&(t.credentials=this.credentials),this.clientApplication&&(t.headers["Client-Application"]=this.clientApplication);var e=this.getJWT();return e&&(t.headers.Authorization=this.generateAuthHeader(e)),t},ti.url=function(t){var e=this.endpoint||"/"+this.jsonapiType,e=""+this.fullBasePath()+e;return e=t?e+"/"+t:e},ti.fullBasePath=function(){return""+this.baseUrl+this.apiNamespace},Object.defineProperty(ti,"middlewareStack",{get:function(){if(this.baseClass){var t=this.baseClass._middlewareStack;if(this.beforeFetch||this.afterFetch){var e=this.beforeFetch?[this.beforeFetch]:t.beforeFilters,r=this.afterFetch?[this.afterFetch]:t.afterFilters;return new Zr(e,r)}return t}return new Zr},set:function(t){this._middlewareStack=t},enumerable:!1,configurable:!0}),ti.scope=function(){return new jr(this)},ti.first=function(){return this.scope().first()},ti.all=function(){return this.scope().all()},ti.find=function(t){return this.scope().find(t)},ti.where=function(t){return this.scope().where(t)},ti.page=function(t){return this.scope().page(t)},ti.per=function(t){return this.scope().per(t)},ti.extraParams=function(t){return this.scope().extraParams(t)},ti.extraFetchOptions=function(t){return this.scope().extraFetchOptions(t)},ti.order=function(t){return this.scope().order(t)},ti.select=function(t){return this.scope().select(t)},ti.selectExtra=function(t){return this.scope().selectExtra(t)},ti.stats=function(t){return this.scope().stats(t)},ti.includes=function(t){return this.scope().includes(t)},ti.merge=function(t){return this.scope().merge(t)},ti.setJWT=function(t){this.credentialStorage.setJWT(t)},ti.getJWT=function(){return this.credentialStorage.getJWT()},Object.defineProperty(ti,"jwt",{get:function(){return this.getJWT()},set:function(t){this.setJWT(t)},enumerable:!1,configurable:!0}),ti.generateAuthHeader=function(t){return'Token token="'+t+'"'},ti.getJWTOwner=function(){return this.logger.warn("SpraypaintBase#getJWTOwner() is deprecated. Use #baseClass property instead"),this.baseClass},ti.serializeKey=function(t){switch(this.keyCase.server){case"dash":return Ur(Mr(t));case"snake":return Mr(t);case"camel":return Lr(Mr(t),!1)}},ti.deserializeKey=function(t){switch(this.keyCase.client){case"dash":return Ur(Mr(t));case"snake":return Mr(t);case"camel":return Lr(Mr(t),!1)}},ti.prototype.destroy=function(){return s(this,void 0,void 0,function(){var e,r,i,n=this;return u(this,function(t){switch(t.label){case 0:e=this.klass.url(this.id),r=new h(this._middleware(),this.klass.logger),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.delete(e,this._fetchOptions())];case 2:return i=t.sent(),[3,4];case 3:throw t.sent();case 4:return 202!==i.status?[3,6]:[4,this._handleAcceptedResponse(i,this.onDeferredDestroy)];case 5:return[2,t.sent()];case 6:return this.klass.baseClass.store.destroy(this),[4,this._handleResponse(i,function(){n.isPersisted=!1})];case 7:return[2,t.sent()]}})})},ti.prototype.save=function(c){return void 0===c&&(c={}),s(this,void 0,void 0,function(){var e,r,i,n,s,o,a=this;return u(this,function(t){switch(t.label){case 0:if(e=this.klass.url(),r="post",i=new h(this._middleware(),this.klass.logger,{patchAsPost:this.klass.patchAsPost}),n=new k(this,c.with),this.isPersisted&&(e=this.klass.url(this.id),r="patch"),c.returnScope){if((o=c.returnScope).model!==this.klass)throw new Error("returnScope must be a scope of type Scope<"+this.klass.name+">");e=e+"?"+o.toQueryParams()}this.clearErrors(),o=n.asJSON(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i[r](e,o,this._fetchOptions())];case 2:return s=t.sent(),[3,4];case 3:throw t.sent();case 4:return 202!==s.status&&204!==s.status?[3,6]:[4,this._handleAcceptedResponse(s,this.onDeferredUpdate)];case 5:return[2,t.sent()];case 6:return[4,this._handleResponse(s,function(){a.fromJsonapi(s.jsonPayload.data,s.jsonPayload,n.includeDirective),n.postProcess()})];case 7:return[2,t.sent()]}})})},ti.prototype._handleAcceptedResponse=function(r,i){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return r.jsonPayload&&i&&(e=this.klass.fromJsonapi(r.jsonPayload.data,r.jsonPayload),i(e)),[4,this._handleResponse(r,function(){})];case 1:return[2,t.sent()]}})})},ti.prototype._handleResponse=function(e,r){return s(this,void 0,void 0,function(){return u(this,function(t){if(a(this.klass,e),422!==e.status)return r(),[2,!0];try{o.apply(this,e.jsonPayload)}catch(t){throw new g(e,"validation failed",t)}return[2,!1]})})},ti.prototype._fetchOptions=function(){return this.klass.fetchOptions()},ti.prototype._middleware=function(){return this.klass.middlewareStack},ti.prototype.resetRelationTracking=function(t){this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(t))},Object.defineProperty(ti.prototype,"links",{get:function(){return this._links},set:function(t){this._links={},this.assignLinks(t)},enumerable:!1,configurable:!0}),ti.prototype.assignLinks=function(t){if(t)for(var e in t){var r=this.klass.deserializeKey(e);-1<this.klass.linkList.indexOf(r)&&(this._links[r]=t[e])}},ti.baseUrl="http://please-set-a-base-url.com",ti.apiNamespace="/",ti.keyCase={server:"snake",client:"camel"},ti.strictAttributes=!1,ti.logger=qr,ti.sync=!1,ti.clientApplication=null,ti.patchAsPost=!1,ti.attributeList={},ti.linkList=[],(ti.currentClass=ti)._jwtStorage="jwt",ti.isSpraypaintModel=!0,e([Qr],ti.prototype,"afterSync",void 0),e([Qr],ti.prototype,"relationships",void 0),e([Qr],ti.prototype,"klass",void 0),e([Qr],ti.prototype,"_persisted",void 0),e([Qr],ti.prototype,"_markedForDestruction",void 0),e([Qr],ti.prototype,"_markedForDisassociation",void 0),e([Qr],ti.prototype,"_originalRelationships",void 0),e([Qr],ti.prototype,"_attributes",void 0),e([Qr],ti.prototype,"_originalAttributes",void 0),e([Qr],ti.prototype,"_links",void 0),e([Qr],ti.prototype,"_originalLinks",void 0),e([Qr],ti.prototype,"__meta__",void 0),e([Qr],ti.prototype,"_metaDirty",void 0),e([Qr],ti.prototype,"_errors",void 0),ti);function ti(t){this.stale=!1,this.storeKey="",this.relationships={},this._persisted=!1,this._markedForDestruction=!1,this._markedForDisassociation=!1,this._originalRelationships={},this._metaDirty=!1,this._errors={},this._initializeAttributes(),this._initializeLinks(),this.assignAttributes(t),this._originalAttributes=nr(this._attributes),this._originalLinks=nr(this._links),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))}(Xr.prototype.klass=Xr).initializeCredentialStorage();function ei(t,e){return t!==e}var ri=function(t){return!!t&&(t.currentClass&&t.currentClass.isSpraypaintModel)},ii=(ni.prototype.apply=function(t){Object.defineProperty(t.prototype,this.name,this.descriptor())},ni.prototype.setter=function(t,e){t._attributes[this.name]=e},ni.prototype.getter=function(t){return t.attributes[this.name]},ni.prototype.descriptor=function(){var e=this;return{configurable:!0,enumerable:!0,get:function(){return e.getter(this)},set:function(t){e.setter(this,t)}}},ni);function ni(t){this.isRelationship=!1,this.type=void 0,this.persist=!0,this.dirtyChecker=ei,t&&(t.name&&(this.name=t.name),t.type&&(this.type=t.type),void 0!==t.persist&&(this.persist=!!t.persist),t.dirtyChecker&&(this.dirtyChecker=t.dirtyChecker))}function si(t){return!!t.klass.sync&&((t.isPersisted||t.stale)&&!t.stored)}var oi,kt=(c(ai,oi=ii),Object.defineProperty(ai.prototype,"klass",{get:function(){return this._klass||(this._klass=gi(this,this.jsonapiType)),this._klass},enumerable:!1,configurable:!0}),ai.prototype.getter=function(t){var e=t.relationships[this.name];return e&&si(e)&&delete t.relationships[this.name],t.relationships[this.name]},ai.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof Xr||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},ai);function ai(t){var e=oi.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}var ci,ui=(c(li,ci=ii),Object.defineProperty(li.prototype,"klass",{get:function(){return this._klass||(this._klass=gi(this,this.jsonapiType)),this._klass},enumerable:!1,configurable:!0}),li.prototype.getter=function(t){var e=t.relationships[this.name];if(!e)return this.setter(t,[]),t.relationships[this.name];for(var r=e.length;r--;)si(e[r])&&(t.relationships[this.name],e.splice(r,1));return t.relationships[this.name]},li.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof Xr||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},li);function li(t){var e=ci.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}var pi,hi=(c(fi,pi=kt),fi);function fi(){return null!==pi&&pi.apply(this,arguments)||this}var di,yi=(c(bi,di=kt),bi);function bi(){return null!==di&&di.apply(this,arguments)||this}function vi(t){var e={};return void 0!==t&&("string"==typeof t?e={jsonapiType:t}:(e={persist:t.persist,name:t.name},"string"==typeof t.type?e.jsonapiType=t.type:e.type=t.type)),e}var gi=function(t,e){t=t.owner.typeRegistry.get(e);if(t)return t;throw new Error('Unknown type "'+e+'"')},_i="undefined"!=typeof window,mi={productionTip:!("production"===process.env.NODE_ENV)};function ji(o){return function(r,t,n){function i(t,e){void 0===n?(i=zr(Mr(e)),s={jsonapiType:i}):"string"==typeof n?s={jsonapiType:n}:ri(n)?s={type:n}:(s={persist:n.persist,name:n.name},"string"==typeof n.type?s.jsonapiType=n.type:s.type=n.type);var r=new o(s);r.name||(r.name=e);var i=(i=t.constructor,Oi(i),i);return(i.attributeList[e]=r).owner=t.constructor,r.apply(i),r.descriptor()}var s;if(wi(r))return Object.assign(r,{finisher:function(t){i(t.prototype,r.key)}});if(!ri(r)||!t)return function(e,t){return wi(e)?Object.assign(e,{finisher:function(t){i(t.prototype,e.key)}}):(n=r,i(e,t))};i(r.prototype,t)}}var wi=function(t){return t&&void 0!==t.kind},Oi=function(t){t.currentClass!==t&&t.currentClass.inherited(t)},I=ji(ui),L=ji(hi),kt=ji(yi);t.SpraypaintBase=Xr,t.Attribute=ii,t.attr=function(t){return new ii(t=t||{})},t.hasMany=function(t){t=vi(t);return new ui(t)},t.hasOne=function(t){t=vi(t);return new hi(t)},t.belongsTo=function(t){t=vi(t);return new yi(t)},t.Model=function(e){return r=function(t){return function(t,e){if(Oi(t),Yr(t,e||{}),!t.jsonapiType&&!t.isBaseClass){t.jsonapiType=zr(Mr(t.name));if(mi.productionTip&&_i)qr.warn('Inferring model jsonapiType as "'+t.jsonapiType+'".\nYou should explicitly set this on your model if targeting a minified code bundle.')}t.registerType()}(t,e),t},function(t){return wi(t)?Object.assign(t,{finisher:r}):r(t)};var r},t.Attr=function(e,t,r){function i(t,e){return Oi(t),n.name||(n.name=e),(t.attributeList[e]=n).apply(t),n.descriptor()}var n=new ii({name:t});if(wi(e))return Object.assign(e,{finisher:function(t){i(t,e.key)}});if(!(ri(e)||(s=e)&&ri(s.constructor.currentClass)))return e&&(n=new ii(e)),function(t,e){return i(t.constructor,e)};if(!t)throw new Error("Must provide a propertyKey");var s=e;if(!ri(s))return i(s.constructor,t);r&&(n=new ii(r)),i(s,t)},t.HasMany=I,t.HasOne=L,t.BelongsTo=kt,t.Link=function(e){function r(t,e){Oi(t),t.linkList.push(e)}return wi(e)?Object.assign(e,{finisher:function(t){r(t,e.key)}}):function(t,e){r(t.constructor,e)}},t.MiddlewareStack=Zr,t.Scope=jr,t.Request=h,Object.defineProperty(t,"__esModule",{value:!0})});
